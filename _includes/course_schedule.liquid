{% assign course = site.teachings | where: 'course_id', include.course_id | first %}

{% if course %}
  <div class="course">
    
    <div class="course-info p-4 mb-5 rounded-3">
      <div class="row g-3 align-items-center">
        <div class="col-12 mb-1">
          {% if course.instructor %}
            <span class="course-tag-base tag-instructor"><i class="fas fa-user-circle me-2"></i>{{ course.instructor }}</span>
          {% endif %}
          {% if course.course_id %}
            <span class="course-tag-base tag-id">{{ course.course_id }}</span>
          {% endif %}
          {% if course.course_level %}
            <span class="course-tag-base tag-level">{{ course.course_level }}</span>
          {% endif %}
        </div>
        <div class="col-12 my-0"><hr style="opacity: 0.1; margin: 8px 0 16px 0;"></div>
        {% if course.term %}<div class="col-md-6"><strong>Term:</strong> {{ course.term }}</div>{% endif %}
        {% if course.location %}<div class="col-md-6"><strong>Location:</strong> {{ course.location }}</div>{% endif %}
      </div>
    </div>

    {% if course.description %}
      <div class="course-description mb-4">
        {{ course.description | markdownify }}
      </div>
    {% endif %}

    {% if course.schedule %}
      <h2 class="mt-5 mb-4">Schedule</h2>
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th class="text-center" style="width: 80px;">Week</th>
              <th>Topic</th>
              <th>Materials</th>
            </tr>
          </thead>
          <tbody>
            {% for entry in course.schedule %}
              <tr>
                <td class="text-center">{{ entry.week }}</td>
                <td>
                  {% if entry.topic %}<div class="fw-bold" style="font-size: 1.05rem;">{{ entry.topic }}</div>{% endif %}
                  {% if entry.description %}<div class="schedule-description text-muted small mt-1">{{ entry.description | markdownify | remove: '<p>' | remove: '</p>' }}</div>{% endif %}
                </td>
                <td>
                  {% if entry.materials %}
                    <ul class="schedule-materials list-unstyled mb-0">
                      {% for material in entry.materials %}
                        <li class="mb-2">
                          {% if material.url %}
                            <a href="{{ material.url | relative_url }}" target="_blank">
                              <i class="fas fa-link me-1" style="font-size: 0.8em; opacity: 0.7;"></i>{{ material.name }}
                            </a>
                          {% else %}
                            <span class="text-secondary">{{ material.name }}</span>
                          {% endif %}
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>
{% endif %}
